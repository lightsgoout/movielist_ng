{% extends 'main.html' %}
{% load i18n %}
{% load static %}
{% block body %}
    <link href="{% static "flag-icon-css/css/flag-icon.min.css" %}" rel="stylesheet">
    <script src="{% static "angular/angular.min.js" %}" type="text/javascript"></script>
    <script src="{% static "angular-resource/angular-resource.min.js" %}" type="text/javascript"></script>
    <script src="{% static "angular-ui-utils/ui-utils.min.js" %}" type="text/javascript"></script>
    <link href="{% static "angular-xeditable/dist/css/xeditable.css" %}" rel="stylesheet">
    <script src="{% static "angular-xeditable/dist/js/xeditable.js" %}" type="text/javascript"></script>

    <script src="{% static "app/utils/tasty-resource.js" %}" type="text/javascript"></script>
    <script src="{% static "app/pages/movie/movie.js" %}" type="text/javascript"></script>
    <link href="{% static "app/pages/movie/movie.css" %}" rel="stylesheet">
    <link href="{% static "app/pages/user-score.css" %}" rel="stylesheet">
    <div class="container" ng-app="MoviePage">
        <div class="row">
            <div class="col-md-4">
                <div class="row text-center">
                    <img src="{{ movie.image_url }}" style="margin-top: 20px; max-height: 445px;">
                </div>

                <div class="row text-center" ng-controller="ScoreController" ng-init="init({{ movie.id }})" style="margin-top:20px;">
                        <div class="user-status">
                            <a href="#"
                               editable-select="user_to_movie.status"
                               e-name="status"
                               buttons="no"
                               e-ng-options="s.id as s.text for s in STATUSES"
                               onaftersave="save()">
                                {% verbatim %}
                                <span class="ng-scope user-status-{{ user_to_movie.status }} lead">{{ showStatus() }}</span>
                                {% endverbatim %}
                            </a>
                        </div>

                        <div class="user-score" ng-show="user_to_movie.status == 'W'">
                            <a href="#"
                               editable-select="user_to_movie.score"
                               e-name="score"
                               buttons="no"
                               e-ng-options="s as s for s in SCORE_CHOICES"
                               onaftersave="save()">
                                {% verbatim %}
                                <span class="ng-scope user-score-digit user-score-{{ user_to_movie.score }} lead">{{ showScore() }}</span>
                                 {% endverbatim %}
                            </a>
                        </div>
                </div>

            </div>
            <div class="col-md-8">
                <h1>{{ movie.title }}</h1>
{#                {% if movie.full_plot %}#}
{#                <blockquote>{{ movie.full_plot}}</blockquote>#}
{#                {% endif %}#}
                <div class="row">
                    <div class="col-md-8">
                        <table class="table table-striped table-condensed">
                            <caption>{% trans 'Movie information' %}</caption>
                            <tr>
                                <th>{% trans 'Year' %}</th>
                                <td>{{ movie.year }}</td>
                            </tr>
                            <tr>
                                <th>{% trans 'Country' %}</th>
                                <td>
                                    {% for country in movie.countries.all %}
                                        <span class="flag-icon flag-icon-{{ country.iso_code|lower }}" title="{{ country.name }}"></span>
                                    {% endfor %}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    {% if movie.directors.all|length > 1 %}
                                        {% trans 'Directors' %}
                                    {% else %}
                                        {% trans 'Director' %}
                                    {% endif %}
                                </th>
                                <td>
                                    {% for person in movie.directors.all %}
                                        <a href="{% url 'person' person_id=person.id %}">{{ person.name }}</a>{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    {% if movie.writers.all|length > 1 %}
                                        {% trans 'Writers' %}
                                    {% else %}
                                        {% trans 'Writer' %}
                                    {% endif %}
                                </th>
                                <td>
                                    {% for person in movie.unique_writers %}
                                        <a href="{% url 'person' person_id=person.id %}">{{ person.name }}</a>{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    {% if movie.producers.all|length > 1 %}
                                        {% trans 'Producers' %}
                                    {% else %}
                                        {% trans 'Producer' %}
                                    {% endif %}
                                </th>
                                <td>
                                    {% for person in movie.producers.all %}
                                        <a href="{% url 'person' person_id=person.id %}">{{ person.name }}</a>{% if not forloop.last %}, {% endif %}
                                    {% empty %}
                                        -
                                    {% endfor %}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    {% if movie.composers.all|length > 1 %}
                                        {% trans 'Composers' %}
                                    {% else %}
                                        {% trans 'Composer' %}
                                    {% endif %}
                                </th>
                                <td>
                                    {% for person in movie.composers.all %}
                                        <a href="{% url 'person' person_id=person.id %}">{{ person.name }}</a>{% if not forloop.last %}, {% endif %}
                                    {% empty %}
                                        -
                                    {% endfor %}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    {% trans 'Genre' %}
                                </th>
                                <td>
                                    {% for genre in movie.genres.all %}
                                        <a href="#">{{ genre.name|lower }}</a>{% if not forloop.last %}, {% endif %}
                                    {% endfor %}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    {% trans 'MPAA rating' %}
                                </th>
                                <td>
                                    {{ movie.rated }}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    {% trans 'Runtime' %}
                                </th>
                                <td>
                                    {{ movie.runtime }}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    {% trans 'Tagline' %}
                                </th>
                                <td>
                                    {% if movie.tagline %}
                                        {{ movie.tagline }}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                        </table>
                        <table class="table table-striped table-condensed">
                            <caption>{% trans 'Movie ratings' %}</caption>
                            <tr>
                                <th>{% trans 'IMDB rating' %}</th>
                                <td>{{ movie.rating_imdb }}</td>
                            </tr>
                            <tr>
                                <th>{% trans 'Metascore' %}</th>
                                <td>{{ movie.rating_metacritic }}</td>
                            </tr>
                            <tr>
                                <th>{% trans 'Rotten Tomatoes' %}</th>
                                <td>{{ movie.rating_tomatoes }}%</td>
                            </tr>
                        </table>
                    </div>
                    <div class="col-md-4">
                        <table class="table table-striped table-condensed">
                            <caption>{% trans 'Cast' %}</caption>
                            {% for person in cast %}
                                <tr>
                                    <td>
                                        <a href="{% url 'person' person_id=person.id %}">{{ person.name }}</a>
                                    </td>
                                </tr>
                            {% endfor %}
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
